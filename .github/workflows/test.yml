name: Test
on: push

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      -
        name: Checkout
        uses: actions/checkout@v1
      - name: Cache Lua
        id: cache-lua
        uses: actions/cache@v1
        with:
          path: .lua
          key: ${{ runner.os }}-lua-5.2
      -
        name: Install Lua from Cache
        if: steps.cache-lua.outputs.cache-hit == 'true'
        run: export PATH=$PATH;"~/work/linter-library/linter-library/.lua/bin"
      -
        name: Install Lua from Download
        if: steps.cache-lua.outputs.cache-hit != 'true'
        uses: leafo/gh-actions-lua@v3
        with:
          luaVersion: "5.2"
      - name: Which Lua?
        run: which lua
      -
        name: Lint
        run: |
          lua componentlint.lua tests/auto_*